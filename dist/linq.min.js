/*! linqjs v0.1.0 */
!function(a,b){"use strict";function c(a){var b=a.length,c=d(a);return"window"===c?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function d(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1].toLowerCase()}function e(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}var f=a.linq={},g=f.enumerable=function(a){return this instanceof g?(this.enumerator=function(){return new a},void 0):new g(a)};f.fn=g.prototype,f.extend=function(a){var b;for(b in a)a.hasOwnProperty(b)&&(f.fn[b]=a[b])},f.from=a.from=function(a){if(a=a||[],"function"===d(a.enumerator))return a;if(!c(a)){var b,e=a;a=[];for(b in e)e.hasOwnProperty(b)&&a.push({key:b,value:e[b]})}return new g(function(){var b=-1,c=a.length;this.current=function(){return 0>b||b>=c?null:a[b]},this.next=function(){return++b<c}})},f.times=a.times=function(a){for(var b=0,c=[];a>b;b++)c.push(b);return f.from(c)},f.range=a.range=function(a,b){"array"===d(a)&&(b=a[1],a=a[0]);for(var c=[];b>=a;a++)c.push(a);return f.from(c)};var h=/^\(? *([a-zA-Z_$]+[a-zA-Z_$0-9]* *(?:, *[a-zA-Z_$]+[a-zA-Z_$0-9]* *)*)?\)?$/,i=/^\| *([a-zA-Z_$]+[a-zA-Z_$0-9]* *(?:, *[a-zA-Z_$]+[a-zA-Z_$0-9]* *)*)\|/;f.lambda=function(a){if("string"!==d(a))return a;a=e(a);var b,c;if(i.test(a))b=a.match(i)[1],c=a.substr(a.indexOf("|",1)+1);else{if(-1===a.indexOf("=>"))throw new SyntaxError("Not a valid lambda expression. Example: x => x.foo");var f=a.split("=>");if(b=e(f.shift()),c=f.join("=>"),""===b)throw new SyntaxError("Lambda signature missing. For a parameterless signature, use: () => 42");if(!h.test(b))throw new SyntaxError("Lambda signature is invalid.");b=b.match(h)[1]}if(c=e(c||""),""===c)throw new SyntaxError("Lambda must return something.");return new Function(b,"return "+c)},f.extend({select:function(a){if(a=f.lambda(a),!a)throw new Error("A selector is required.");var b=this;return f.enumerable(function(){var c=null,d=b.enumerator(),e=0;this.current=function(){return c},this.next=function(){var f;return c=(f=d.next())?a.call(b,d.current(),e++):null,f}})},where:function(a){a=f.lambda(a);var b=this;return f.enumerable(function(){var c=b.enumerator(),d=0;this.current=c.current,this.next=function(){for(;c.next();)if(a.call(b,c.current(),d++))return!0;return!1}})},take:function(a){var b=this;return f.enumerable(function(){var c=b.enumerator(),d=0;this.current=c.current,this.next=function(){return d++<a&&c.next()}})},skip:function(a){var b=this;return f.enumerable(function(){var c=b.enumerator(),d=0;this.current=c.current,this.next=function(){for(;a>d&&c.next();)d++;return c.next()}})},step:function(a){var b=this;return f.enumerable(function(){var c=b.enumerator(),d=!1;this.current=c.current,this.next=function(){if(!d)return d=!0,c.next();for(var b=1;a>b&&c.next();)b++;return c.next()}})},groupBy:function(a){var b=this;if(a=f.lambda(a),!a)throw new Error("A key selector is required.");return f.enumerable(function(){for(var c=b.enumerator(),d=[],e={};c.next();){var f=c.current(),g=a(f);e[g]||(e[g]={key:g,items:[]},d.push(g)),e[g].items.push(f)}var h=-1,i=d.length;this.current=function(){return 0>h||h>=i?null:e[d[h]]},this.next=function(){return++h<i}})},union:function(a){var b=this;return a=f.from(a),f.enumerable(function(){var c=b.enumerator(),d=a.enumerator(),e=!0;this.current=function(){return e?c.current():d.current()},this.next=function(){return c.next()||(e=!1)||d.next()}})},orderBy:function(a){var b=this;if(a=f.lambda(a),!a)throw new Error("A selector is required.");var c=function(b,c,d){d&&(d.handled=!0);var e=a(b),f=a(c);return e>f?1:f>e?-1:0},d=f.enumerable(function(){return from(b.array().sort(c)).enumerator()});d.thenBy=function(a){if(!a)throw new Error("A selector is required.");a=f.lambda(a);var b=c;return c=function(c,d,e){var f=b(c,d);if(0===f){e&&(e.handled=!0);var g=a(c),h=a(d);f=g>h?1:h>g?-1:0}return f},d.descending=e,d};var e=function(){var a=c;return c=function(b,c){var d={},e=a(b,c,d);return d.handled?-1*e:e},delete d.descending,d};return d.descending=e,d},distinct:function(a){function b(a,b){if(a.indexOf)return-1!==a.indexOf(b);for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}var c=this;return a=f.lambda(a),f.enumerable(function(){var d=c.enumerator(),e=[];this.current=d.current,this.next=function(){for(;d.next();){var c=a?a(d.current()):d.current();if(!b(e,c))return e.push(c),!0}return!1}})},reverse:function(){var a=this;return f.enumerable(function(){var b=a.array(),c=b.length,d=c;this.current=function(){return d>-1&&c>d?b[d]:null},this.next=function(){return--d>-1}})},selectMany:function(a){var b=this;return a=f.lambda(a),f.enumerable(function(){var c=b.enumerator(),d=null;this.current=function(){return d?d.current():null},this.next=function(){for(;;)if(null===d){if(!c.next())return!1;d=from(a?a(c.current()):c.current()).enumerator()}else{if(d.next())return!0;d=null}}})}}),f.extend({each:function(a){for(var b=this.enumerator(),c=0;b.next()&&a.call(this,b.current(),c++)!==!1;);},array:function(){for(var a=[],b=this.enumerator();b.next();)a.push(b.current());return a},first:function(){var a=this.enumerator();return a.next(),a.current()},last:function(){for(var a=this.enumerator(),b=null;a.next();)b=a.current();return b},count:function(){for(var a=this.enumerator(),b=0;a.next();)b++;return b},hash:function(a,c){var d,e,g,h=this,i={},j=this.enumerator(),k=arguments.length>0&&!!a,l=arguments.length>1,m=0;for(a=f.lambda(a),c=f.lambda(c);j.next();)g=j.current(),d=k?a.call(h,g):g.key!==b?g.key:m,e=l?c.call(h,g):g.value!==b?g.value:g,i[d]=e,m++;return i},contains:function(a){for(var b=this.enumerator();b.next();)if(b.current()===a)return!0;return!1},any:function(){return null!==this.first()},min:function(a){a=f.lambda(a);for(var b=null,c=this.enumerator();c.next();){var d=a?a(c.current()):c.current();(null===b||b>d)&&(b=d)}return b},max:function(a){a=f.lambda(a);for(var b=null,c=this.enumerator();c.next();){var d=a?a(c.current()):c.current();(null===b||d>b)&&(b=d)}return b},sum:function(a){a=f.lambda(a);for(var b=0,c=this.enumerator();c.next();)b+=a?a(c.current()):c.current();return b}})}(window);