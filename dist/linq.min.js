/*! linqjs v0.1.0 */
!function(a){"use strict";function b(a){var b=a.length,d=c(a);return"window"===d?!1:1===a.nodeType&&b?!0:"array"===d||"function"!==d&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function c(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1].toLowerCase()}function d(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}var e={},f=e.Enumerable=function(a){return this instanceof f?void(this.enumerator=function(){return new a}):new f(a)};e.fn=f.prototype,e.extend=function(a){var b;for(b in a)a.hasOwnProperty(b)&&(e.fn[b]=a[b])},e.from=function(a){if(a=a||[],"function"===c(a.enumerator))return new f(a.enumerator);if(!b(a)){var d,e=a;a=[];for(d in e)e.hasOwnProperty(d)&&a.push({key:d,value:e[d]})}return new f(function(){var b=-1,c=a.length;this.current=function(){return 0>b||b>=c?null:a[b]},this.next=function(){return++b<c}})},e.times=function(a){for(var b=0,c=[];a>b;b++)c.push(b);return e.from(c)},e.range=function(a,b){"array"===c(a)&&(b=a[1],a=a[0]);for(var d=[];b>=a;a++)d.push(a);return e.from(d)};var g=/^\(? *([a-zA-Z_$]+[a-zA-Z_$0-9]* *(?:, *[a-zA-Z_$]+[a-zA-Z_$0-9]* *)*)?\)?$/,h=/^\| *([a-zA-Z_$]+[a-zA-Z_$0-9]* *(?:, *[a-zA-Z_$]+[a-zA-Z_$0-9]* *)*)\|/;e.lambda=function(a,b){if("function"===c(a))return function(){return a.apply(b,arguments)};if("string"!==c(a))return a;a=d(a);var e,f;if(h.test(a))e=a.match(h)[1],f=a.substr(a.indexOf("|",1)+1);else{if(-1===a.indexOf("=>"))throw new SyntaxError("Not a valid lambda expression. Example: x => x.foo");var i=a.split("=>");if(e=d(i.shift()),f=i.join("=>"),""===e)throw new SyntaxError("Lambda signature missing. For a parameterless signature, use: () => 42");if(!g.test(e))throw new SyntaxError("Lambda signature is invalid.");e=e.match(g)[1]}if(f=d(f||""),""===f)throw new SyntaxError("Lambda must return something.");var j=new Function(e,"'use strict'; return "+f);return function(){return j.apply(b,arguments)}},e.extend({select:function(a){if(a=e.lambda(a),!a)throw new Error("A selector is required.");var b=this;return new f(function(){var c=null,d=b.enumerator(),e=0;this.current=function(){return c},this.next=function(){var f;return c=(f=d.next())?a.call(b,d.current(),e++):null,f}})},where:function(a,b){a=e.lambda(a,b);var c=this;return new f(function(){var b=c.enumerator(),d=0;this.current=b.current,this.next=function(){for(;b.next();)if(a.call(c,b.current(),d++))return!0;return!1}})},take:function(a){var b=this;return new f(function(){var c=b.enumerator(),d=0;this.current=c.current,this.next=function(){return d++<a&&c.next()}})},skip:function(a){var b=this;return new f(function(){var c=b.enumerator(),d=0;this.current=c.current,this.next=function(){for(;a>d&&c.next();)d++;return c.next()}})},step:function(a){var b=this;return new f(function(){var c=b.enumerator(),d=!1;this.current=c.current,this.next=function(){if(!d)return d=!0,c.next();for(var b=1;a>b&&c.next();)b++;return c.next()}})},groupBy:function(a){var b=this;if(a=e.lambda(a),!a)throw new Error("A key selector is required.");return new f(function(){for(var c=b.enumerator(),d=[],e={};c.next();){var f=c.current(),g=a(f);e[g]||(e[g]={key:g,items:[]},d.push(g)),e[g].items.push(f)}var h=-1,i=d.length;this.current=function(){return 0>h||h>=i?null:e[d[h]]},this.next=function(){return++h<i}})},union:function(a){var b=this;return a=e.from(a),new f(function(){var c=b.enumerator(),d=a.enumerator(),e=!0;this.current=function(){return e?c.current():d.current()},this.next=function(){return c.next()||(e=!1)||d.next()}})},orderBy:function(a){var b=this;if(a=e.lambda(a),!a)throw new Error("A selector is required.");var c=function(b,c,d){d&&(d.handled=!0);var e=a(b),f=a(c);return e>f?1:f>e?-1:0},d=new f(function(){return e.from(b.toArray().sort(c)).enumerator()});d.thenBy=function(a){if(!a)throw new Error("A selector is required.");a=e.lambda(a);var b=c;return c=function(c,d,e){var f=b(c,d);if(0===f){e&&(e.handled=!0);var g=a(c),h=a(d);f=g>h?1:h>g?-1:0}return f},d.descending=g,d};var g=function(){var a=c;return c=function(b,c){var d={},e=a(b,c,d);return d.handled?-1*e:e},delete d.descending,d};return d.descending=g,d},distinct:function(a){function b(a,b){if(a.indexOf)return-1!==a.indexOf(b);for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}var c=this;return a=e.lambda(a),new f(function(){var d=c.enumerator(),e=[];this.current=d.current,this.next=function(){for(;d.next();){var c=a?a(d.current()):d.current();if(!b(e,c))return e.push(c),!0}return!1}})},reverse:function(){var a=this;return new f(function(){var b=a.toArray(),c=b.length,d=c;this.current=function(){return d>-1&&c>d?b[d]:null},this.next=function(){return--d>-1}})},selectMany:function(a){var b=this;return a=e.lambda(a),new f(function(){var c=b.enumerator(),d=null;this.current=function(){return d?d.current():null},this.next=function(){for(;;)if(null===d){if(!c.next())return!1;d=e.from(a?a(c.current()):c.current()).enumerator()}else{if(d.next())return!0;d=null}}})},join:function(a,b,d){var g=this;return"string"!==c(a)&&(d=b,b=a,a="inner"),d||(d=function(a,b){return a===b}),d=e.lambda(d),new f(function(){var c=g.toArray(),f=e.from(b).toArray(),h="right"===a?f:"left"===a?c:c.length<=f.length?c:f,i=c===h?f:c,j=h.length,k=null,l=0,m=0,n=[];this.current=function(){return k},this.next=function(){if(k=null,m<n.length)k=n[m],m++;else{for(;j>l;){if(n=e.from(i).where(function(a){return d(i===c?a:c[l],i===f?a:f[l])}).toArray(),0!==n.length){n=e.from(n).select(function(a){return i===c?[a,f[l]]:[c[l],a]}).toArray(),k=n[0],m=1;break}if("left"===a){k=[c[l],null];break}if("right"===a){k=[null,f[l]];break}}l++}return null!==k}})}}),e.extend({each:function(a){for(var b=this.enumerator(),c=0;b.next()&&a.call(this,b.current(),c++)!==!1;);},toArray:function(){for(var a=[],b=this.enumerator();b.next();)a.push(b.current());return a},first:function(){var a=this.enumerator();return a.next(),a.current()},last:function(){for(var a=this.enumerator(),b=null;a.next();)b=a.current();return b},count:function(){for(var a=this.enumerator(),b=0;a.next();)b++;return b},toHash:function(a,b){var c,d,f,g=this,h={},i=this.enumerator(),j=arguments.length>0&&!!a,k=arguments.length>1,l=0;for(a=e.lambda(a),b=e.lambda(b);i.next();)f=i.current(),c=j?a.call(g,f):void 0!==f.key?f.key:l,d=k?b.call(g,f):void 0!==f.value?f.value:f,h[c]=d,l++;return h},contains:function(a){for(var b=this.enumerator();b.next();)if(b.current()===a)return!0;return!1},any:function(){return null!==this.first()},min:function(a){a=e.lambda(a);for(var b=null,c=this.enumerator();c.next();){var d=a?a(c.current()):c.current();(null===b||b>d)&&(b=d)}return b},max:function(a){a=e.lambda(a);for(var b=null,c=this.enumerator();c.next();){var d=a?a(c.current()):c.current();(null===b||d>b)&&(b=d)}return b},sum:function(a){a=e.lambda(a);for(var b=0,c=this.enumerator();c.next();)b+=a?a(c.current()):c.current();return b}}),"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):a.linq=e}("undefined"==typeof global?window:global);